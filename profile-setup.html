<!DOCTYPE html>
<html>
<head>
  <title>Profile Setup</title>
</head>
<body>
  <h2>ðŸŽ¯ Setup Your Cricket Manager Profile</h2>
  <form id="profileForm">
    <input type="text" placeholder="Manager Name" id="manager_name" required><br>
    <input type="text" placeholder="Team Name" id="team_name" required><br>
    <input type="date" id="dob" required><br>

    <select id="region" required>
      <optgroup label="Indian States">
        <option>Andhra Pradesh</option>
        <option>Arunachal Pradesh</option>
        <option>Assam</option>
        <option>Bihar</option>
        <option>Chhattisgarh</option>
        <option>Goa</option>
        <option>Gujarat</option>
        <option>Haryana</option>
        <option>Himachal Pradesh</option>
        <option>Jharkhand</option>
        <option>Karnataka</option>
        <option>Kerala</option>
        <option>Madhya Pradesh</option>
        <option>Maharashtra</option>
        <option>Manipur</option>
        <option>Meghalaya</option>
        <option>Mizoram</option>
        <option>Nagaland</option>
        <option>Odisha</option>
        <option>Punjab</option>
        <option>Rajasthan</option>
        <option>Sikkim</option>
        <option>Tamil Nadu</option>
        <option>Telangana</option>
        <option>Tripura</option>
        <option>Uttar Pradesh</option>
        <option>Uttarakhand</option>
        <option>West Bengal</option>
      </optgroup>
      <optgroup label="Union Territories">
        <option>Andaman and Nicobar Islands</option>
        <option>Chandigarh</option>
        <option>Dadra and Nagar Haveli</option>
        <option>Daman and Diu</option>
        <option>Delhi</option>
        <option>Lakshadweep</option>
        <option>Puducherry</option>
        <option>Jammu and Kashmir</option>
        <option>Ladakh</option>
      </optgroup>
      <optgroup label="Top Cricket Nations">
        <option>India</option>
        <option>Australia</option>
        <option>England</option>
        <option>Pakistan</option>
        <option>New Zealand</option>
        <option>South Africa</option>
        <option>West Indies</option>
        <option>Sri Lanka</option>
        <option>Bangladesh</option>
        <option>Afghanistan</option>
        <option>Netherlands</option>
        <option>Ireland</option>
        <option>Zimbabwe</option>
        <option>Scotland</option>
        <option>Namibia</option>
        <option>UAE</option>
        <option>USA</option>
        <option>Oman</option>
      </optgroup>
    </select><br><br>

    <button type="submit">Submit & View Your Squad</button>
  </form>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    const supabase = createClient(
      'https://ejcutfzguoqnkrparcox.supabase.co',
      'your-anon-key-here'
    );

    document.getElementById('profileForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const { data: { user } } = await supabase.auth.getUser();

      const updates = {
        id: user.id,
        manager_name: document.getElementById('manager_name').value,
        team_name: document.getElementById('team_name').value,
        dob: document.getElementById('dob').value,
        region: document.getElementById('region').value,
        xp: 0,
        manager_level: 'Beginner'
      };

      const { error } = await supabase.from('profiles').upsert(updates, { onConflict: ['id'] });

      if (error) {
        alert('Error saving profile: ' + error.message);
      } else {
        window.location.href = '/squad.html';
      }
    });
  </script>
</body>
</html>
